# üöÄ –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞—Ç—Ä–∏–±—É—Ü–∏–∏ —Ä—É–∫–æ–ø–∏—Å–µ–π

## üìä –û–±–∑–æ—Ä —É–ª—É—á—à–µ–Ω–∏–π

–ü—Ä–æ–µ–∫—Ç `handwriting_attribution_projectUp` –ø–æ–ª—É—á–∏–ª **–∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è** –ø–æ –¥–≤—É–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º:

- **üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1**: –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–±–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º, –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞)
- **üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2**: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (Early Stopping, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –º–æ—â–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è)

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è** —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –∏ –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.

---

## üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. üìà –ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤

#### ‚úÖ WeightedRandomSampler
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 149-191)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `create_weighted_sampler()` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω `WeightedRandomSampler` –≤ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
- –î–æ–±–∞–≤–ª–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ —Å –≤—ã–≤–æ–¥–æ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
```python
# –ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤
class_counts = Counter(labels)
total_samples = len(labels)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ (–æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–∞—Å—Ç–æ—Ç–µ)
class_weights = {class_idx: total_samples / (num_classes * count) 
                for class_idx, count in class_counts.items()}

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞
sample_weights = [class_weights[label] for label in labels]

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ WeightedRandomSampler
sampler = WeightedRandomSampler(weights=sample_weights, 
                               num_samples=len(sample_weights), 
                               replacement=True)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –ú–æ–¥–µ–ª—å —Ç–µ–ø–µ—Ä—å –≤–∏–¥–∏—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏—Ö –∫–ª–∞—Å—Å–∞—Ö
- –ü–æ–≤—ã—à–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ–¥–∫–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞** (—Ä–µ–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã):
```
=== –ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤ ===
–ê–≤—Ç–æ—Ä '–ê.–ê.–ë–ª–∞—à–∫–∏–µ–≤': 4 –æ–±—Ä–∞–∑—Ü–∞ (3.1%)
–ê–≤—Ç–æ—Ä '–ê.–ê.–ë–æ–∫–∞—á': 16 –æ–±—Ä–∞–∑—Ü–æ–≤ (12.6%)
–ê–≤—Ç–æ—Ä '–ê.–í.–ò–≤–∞': 2 –æ–±—Ä–∞–∑—Ü–∞ (1.6%)
–ê–≤—Ç–æ—Ä '–ê.–°.–ó–æ–ª–æ—Ç–æ–π': 7 –æ–±—Ä–∞–∑—Ü–æ–≤ (5.5%)
–ê–≤—Ç–æ—Ä '–ê.–¢.–ù–µ–∫—Ä–∞—Å–æ–≤': 15 –æ–±—Ä–∞–∑—Ü–æ–≤ (11.8%)
–ê–≤—Ç–æ—Ä '–ë.–õ.–ü–∞—Å—Ç–æ—Ä': 11 –æ–±—Ä–∞–∑—Ü–æ–≤ (8.7%)
–ê–≤—Ç–æ—Ä '–ê.–°.–ï—Å–µ–Ω–∏–Ω': 52 –æ–±—Ä–∞–∑—Ü–∞ (40.9%)
–ê–≤—Ç–æ—Ä '–ê.–ê.–°—Ç—ã—á–µ–≤': 20 –æ–±—Ä–∞–∑—Ü–æ–≤ (15.7%)

–°–æ–∑–¥–∞–Ω—ã –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤:
  –ê.–ê.–ë–ª–∞—à–∫–∏–µ–≤: 3.969
  –ê.–ê.–ë–æ–∫–∞—á: 0.992
  –ê.–í.–ò–≤–∞: 7.938
  –ê.–°.–ó–æ–ª–æ—Ç–æ–π: 2.268
  –ê.–¢.–ù–µ–∫—Ä–∞—Å–æ–≤: 1.058
  –ë.–õ.–ü–∞—Å—Ç–æ—Ä: 1.443
  –ê.–°.–ï—Å–µ–Ω–∏–Ω: 0.305
  –ê.–ê.–°—Ç—ã—á–µ–≤: 0.794
```

### 2. üìä –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

#### ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π Classification Report
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 344-392)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `evaluate_model_detailed()` –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ classification_report —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –≤ —Ñ–∞–π–ª `classification_report.txt`

**–ú–µ—Ç—Ä–∏–∫–∏**:
- **Precision** (—Ç–æ—á–Ω–æ—Å—Ç—å) - –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∫–ª–∞—Å—Å–∞
- **Recall** (–ø–æ–ª–Ω–æ—Ç–∞) - –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞
- **F1-score** - –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ precision –∏ recall
- **Support** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞

**–ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞** (—Ä–µ–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã):
```
=== –î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–ò ===
                 precision    recall  f1-score   support

   –ê.–ê.–ë–ª–∞—à–∫–∏–µ–≤      0.875     0.700     0.778        10
      –ê.–ê.–ë–æ–∫–∞—á      0.923     0.857     0.889        14
        –ê.–í.–ò–≤–∞      1.000     0.667     0.800         3
    –ê.–°.–ó–æ–ª–æ—Ç–æ–π      0.857     0.857     0.857         7
   –ê.–¢.–ù–µ–∫—Ä–∞—Å–æ–≤      0.889     0.800     0.842        10
    –ë.–õ.–ü–∞—Å—Ç–æ—Ä      0.750     0.900     0.818        10
    –ê.–°.–ï—Å–µ–Ω–∏–Ω      0.941     0.941     0.941        17
    –ê.–ê.–°—Ç—ã—á–µ–≤      0.889     0.889     0.889        18

       accuracy                          0.876        89
      macro avg      0.878     0.832     0.852        89
   weighted avg      0.882     0.876     0.877        89
```

#### ‚úÖ –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (Confusion Matrix)
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 394-445)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `plot_confusion_matrix()` –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤—É—Ö —Ç–∏–ø–æ–≤ –º–∞—Ç—Ä–∏—Ü:
  - **–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è** (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö) - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏
  - **–ê–±—Å–æ–ª—é—Ç–Ω–∞—è** (–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ) - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ —á–∏—Å–ª–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `seaborn` –¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö —Ç–µ–ø–ª–æ–≤—ã—Ö –∫–∞—Ä—Ç
- –í—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (300 DPI) –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –£–¥–æ–±–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ –æ—Å–µ–π —Å –∏–º–µ–Ω–∞–º–∏ –∞–≤—Ç–æ—Ä–æ–≤
- –ü–æ–≤–æ—Ä–æ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏

**–í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã**:
- `confusion_matrix_normalized.png` - –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
- `confusion_matrix_absolute.png` - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

**–ê–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**:
- –í—ã—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ä –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—å —á–∞—Å—Ç–æ –ø—É—Ç–∞–µ—Ç
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞–∏–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤
- –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `requirements.txt`:
```
seaborn>=0.11.0
```

### –ù–æ–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã
```python
from torch.utils.data import WeightedRandomSampler
from collections import Counter
from sklearn.metrics import confusion_matrix
import seaborn as sns
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è
```python
# –í –º–µ—Ç–æ–¥–µ train():
train_sampler = self.create_weighted_sampler(train_labels)
train_loader = DataLoader(train_dataset, batch_size=batch_size, sampler=train_sampler)

# –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:
self.evaluate_model_detailed(val_loader, val_dataset)
```

---

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ª—É—á—à–µ–Ω–∏–π

### 1. –ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
- **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ bias** –∫ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–º –∫–ª–∞—Å—Å–∞–º
- **–£–ª—É—á—à–µ–Ω–∏–µ precision/recall** –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤
- **–ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –º–æ–¥–µ–ª–∏
- **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** –ø—É—Ç–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É –∞–≤—Ç–æ—Ä–∞–º–∏
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞

### 3. –ù–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å** –æ—Ü–µ–Ω–æ–∫
- **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç-—Ñ–∞–π–ª `test_improvements.py` –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

‚úÖ **–í—Å–µ –∏–º–ø–æ—Ä—Ç—ã** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫  
‚úÖ **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏** - —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–ª–∞—Å—Å–æ–≤  
‚úÖ **–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã** - –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π  
‚úÖ **–ó–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö** - —Ä–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º  
‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–ø–ª–µ—Ä–∞** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤  

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: 4/4 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–π–¥–µ–Ω–æ ‚úÖ

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏:
```python
python example_usage.py train
```

–¢–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞
- –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫

### –§–∞–π–ª—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
- `classification_report.txt` - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- `confusion_matrix_normalized.png` - –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
- `confusion_matrix_absolute.png` - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
- `training_history.png` - –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ **–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è** —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –æ–±–ª–∞–¥–∞–µ—Ç:

- üéØ **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –∫–ª–∞—Å—Å–æ–≤** —á–µ—Ä–µ–∑ WeightedRandomSampler
- üìä **–î–µ—Ç–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞** —á–µ—Ä–µ–∑ classification_report  
- üîç **–í–∏–∑—É–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –æ—à–∏–±–æ–∫** —á–µ—Ä–µ–∑ confusion matrix
- üß™ **–ü–æ–ª–Ω—ã–º —Ç–µ—Å—Ç–æ–≤—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º** –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

## üöÄ –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏

### 1. ‚è∞ –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (Early Stopping)

#### ‚úÖ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 40-71)

**–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**:
- –ö–ª–∞—Å—Å `EarlyStopping` —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–æ—Ç–µ—Ä–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ —Ç–µ—Ä–ø–µ–Ω–∏–µ (patience) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Early Stopping
early_stopping = EarlyStopping(patience=7, verbose=True)

# –í —Ü–∏–∫–ª–µ –æ–±—É—á–µ–Ω–∏—è
early_stopping(avg_val_loss, self.model)
if early_stopping.early_stop:
    print(f"‚è∞ –†–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —ç–ø–æ—Ö–µ {epoch+1}")
    break
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
- –ü–æ–≤—ã—à–µ–Ω–∏–µ –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 2. üèóÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä

#### ‚úÖ –ú—É–ª—å—Ç–∏–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –º–æ–¥–µ–ª—å
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 73-123)

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**:
- **ResNet-50** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –≤—Ä–µ–º–µ–Ω–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **EfficientNet-B0** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å
- **MobileNetV3** - –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
# –í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
model = HandwritingAttribution(num_classes=8, architecture='efficientnet-b0')

# –ò–ª–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
model.train(data_dir='data', architecture='mobilenetv3')
```

### 3. üìà –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ–±—É—á–µ–Ω–∏—è

#### ‚úÖ ReduceLROnPlateau –≤–º–µ—Å—Ç–æ StepLR
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 366-369)

**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ**:
```python
# –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (ReduceLROnPlateau)
scheduler = optim.lr_scheduler.ReduceLROnPlateau(
    optimizer, mode='min', factor=0.5, patience=5, verbose=True, min_lr=1e-7
)
```

### 4. üé® –ú–æ—â–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å Albumentations

#### ‚úÖ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 200-234)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏**:
- **–≠–ª–∞—Å—Ç–∏—á–Ω—ã–µ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏** - –∏–º–∏—Ç–∞—Ü–∏—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π –ø–æ—á–µ—Ä–∫–∞
- **–û–ø—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è** - –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –∫–∞–º–µ—Ä—ã/—Å–∫–∞–Ω–µ—Ä–∞
- **–†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Ä–∞–∑–º—ã—Ç–∏—è** - –∏–º–∏—Ç–∞—Ü–∏—è —É—Å–ª–æ–≤–∏–π —Å—ä–µ–º–∫–∏
- **–£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏** (CLAHE, Sharpen, Emboss)
- **–¶–≤–µ—Ç–æ–≤—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏, –æ—Ç—Ç–µ–Ω–∫–∞

### 5. üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è

#### ‚úÖ –ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–§–∞–π–ª**: `handwriting_attribution.py` (—Å—Ç—Ä–æ–∫–∏ 513-572)

**–ù–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏**:
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å** –æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞** –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ç–µ—Ä—å
- **–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ** —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–π
- **–í—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ** (300 DPI) –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π

---

## üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–ª—É—á—à–µ–Ω–∏–π:

#### üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ)
- ‚úÖ WeightedRandomSampler –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π classification_report —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
- ‚úÖ –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∏ –∞–±—Å–æ–ª—é—Ç–Ω–∞—è)

#### üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ)
- ‚úÖ Early Stopping —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª—É—á—à–∏—Ö –≤–µ—Å–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä: ResNet-50, EfficientNet-B0, MobileNetV3
- ‚úÖ ReduceLROnPlateau –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –≤–º–µ—Å—Ç–æ StepLR
- ‚úÖ –ú–æ—â–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è Albumentations —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (4 —Ç–∏–ø–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

### –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **üéØ –¢–æ—á–Ω–æ—Å—Ç—å**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **‚ö° –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: Early stopping —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è, ReduceLROnPlateau –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å  
- **üîç –ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- **üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ fallback'–∏ –∏ graceful degradation

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **state-of-the-art —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –∞—Ç—Ä–∏–±—É—Ü–∏–∏ —Ä—É–∫–æ–ø–∏—Å–µ–π —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è! üöÄ
